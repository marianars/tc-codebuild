version: 0.2

phases:
  install:
    runtime-versions:
      terraform: 1.0
    commands:
      # Descargar e instalar la versiÃ³n de Terraform especificada en la fase install
      curl -O https://releases.hashicorp.com/terraform/1.0.9/terraform_1.0.9_linux_amd64.zip
      unzip terraform_1.0.9_linux_amd64.zip
      mv terraform /usr/local/bin/

  pre_build:
    commands:
      # Configurar las credenciales de AWS
      echo "Setting AWS credentials..."
      echo $AWS_ACCESS_KEY_ID > ~/.aws/credentials
      echo $AWS_SECRET_ACCESS_KEY >> ~/.aws/credentials
      echo $AWS_DEFAULT_REGION >> ~/.aws/config
      echo "Running Terraform commands..."
      terraform init -input=false -backend-config="bucket=new-tc-terraform-state"

  build:
    commands:
      echo "Applying Terraform changes..."
      terraform plan

  post_build:
    commands:
      echo "Build complete"


